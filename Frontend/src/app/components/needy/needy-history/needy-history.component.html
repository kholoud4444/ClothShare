<div class="container mt-2">
  <!-- Conditional rendering for requests -->
  <ng-container *ngIf="requests.length > 0; else failureOrLoading">
    <div class="card">
      <div class="card-header text-center">الطلبات</div>
      <div class="card-body">
        <!-- Responsive Table -->
        <div class="table-responsive">
          <table class="table table-bordered text-center">
            <thead class="thead-light">
            <tr>
              <th>حذف</th>
              <th>السبب</th>
              <th>الحالة</th>
              <th>الصورة</th>
              <th>التاريخ</th>
              <th>نوع العنصر</th>
              <th>الحجم</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let n of requests">
              <td>
                <button
                  class="btn btn-danger btn-sm"
                  (click)="handleDeleteRequest(n.requestId)"
                >
                  <i class="bi bi-trash"></i> حذف
                </button>
              </td>
              <td>{{ n.reason }}</td>
              <td>{{ n.requestStatus }}</td>
              <td>
                <img
                  [src]="n.itemData.imageUrl"
                  alt="Item Image"
                  width="100"
                  class="img-thumbnail"
                />
              </td>
              <td>{{ n.date | date: 'dd/MM/yyyy' }}</td>
              <td>{{ n.itemData.type }}</td>
              <td>{{ n.itemData.size }}</td>
            </tr>
            </tbody>
          </table>
        </div>

        <!-- Pagination -->
        <p-paginator
          [rows]="pageSize"
          [totalRecords]="totalRecords"
          [first]="currentPage * pageSize"
          [rowsPerPageOptions]="[5, 10, 20]"
          (onPageChange)="onPageChange($event)"
        ></p-paginator>
      </div>
    </div>
  </ng-container>

  <!-- Error or Loading State -->
  <ng-template #failureOrLoading>
    <ng-container *ngIf="errorMessage; else loading">
      <div class="alert alert-danger text-center">
        {{ errorMessage }}
      </div>
    </ng-container>
    <ng-template #loading>
      <div class="text-center mt-4">
        <div class="spinner-border text-primary" role="status">
          <span class="sr-only">Loading...</span>
        </div>
        <p>جاري التحميل...</p>
      </div>
    </ng-template>
  </ng-template>
</div>
